ghistfig2g <- ggplot(subset(brghist1a, variable == "Unit cost rate"), aes(x = t, y = value)) +
geom_line(aes(colour = tnow)) + coord_cartesian(ylim = c(0, 3)) +
xlab(expression(t)) + ylab(expression(paste(g^(t[now]), (t)))) +
guides(colour=guide_legend(title=expression(t[now]))) +
theme(legend.position = 'bottom', legend.direction = 'horizontal') +
scale_x_continuous(breaks = seq(0, 18, by = 2), minor_breaks = 0:18)
ghistfig2g
ghistfig2g <- ggplot(subset(brghist1a, variable == "Unit cost rate"), aes(x = t, y = value)) +
geom_line(aes(colour = tnow)) + coord_cartesian(xlim = c(0, 18), ylim = c(0, 3)) +
xlab(expression(t)) + ylab(expression(paste(g^(t[now]), (t)))) +
guides(colour=guide_legend(title=expression(t[now]))) +
theme(legend.position = 'bottom', legend.direction = 'horizontal') +
scale_x_continuous(breaks = seq(0, 18, by = 2), minor_breaks = 0:18)
ghistfig2g
grid.arrange(ghistfig2r, ghistfig2g, nrow = 2)
ghistfig2g <- ggplot(subset(brghist1a, variable == "Unit cost rate"), aes(x = t, y = value)) +
geom_line(aes(colour = tnow)) + coord_cartesian(xlim = c(0, 18), ylim = c(0, 3)) +
xlab(expression(t)) + ylab(expression(paste(g[sys]^(t[now]), (t)))) +
guides(colour=guide_legend(title=expression(t[now]))) +
theme(legend.position = 'bottom', legend.direction = 'horizontal') +
scale_x_continuous(breaks = seq(0, 18, by = 2), minor_breaks = 0:18) +
scale_y_continuous(breaks = seq(0, 3, by = 0.5), minor_breaks = seq(0, 3, by = 0.25))
grid.arrange(ghistfig2r, ghistfig2g, nrow = 2)
?scale_x_continuous
ghistfig2r <- ggplot(subset(brghist1a, variable == "Reliability"), aes(x = t, y = value)) +
geom_line(aes(colour = tnow)) + coord_cartesian(xlim = c(0, 18), ylim = c(0, 1)) +
xlab(expression(t)) + ylab(expression(paste(R[sys]^(t[now]), (t)))) + guides(colour = 'none') +
scale_x_continuous(breaks = seq(0, 18, by = 2), minor_breaks = 0:18) +
scale_y_continuous(breaks = seq(0, 1, by = 0.2), minor_breaks = seq(0, 1, by = 0.1))
ghistfig2g <- ggplot(subset(brghist1a, variable == "Unit cost rate"), aes(x = t, y = value)) +
geom_line(aes(colour = tnow)) + coord_cartesian(xlim = c(0, 18), ylim = c(0, 3)) +
xlab(expression(t)) + ylab(expression(paste(g[sys]^(t[now]), (t)))) +
guides(colour=guide_legend(title=expression(t[now]))) +
theme(legend.position = 'bottom', legend.direction = 'horizontal') +
scale_x_continuous(breaks = seq(0, 18, by = 2), minor_breaks = 0:18) +
scale_y_continuous(breaks = seq(0, 3, by = 0.5), minor_breaks = seq(0, 3, by = 0.25))
grid.arrange(ghistfig2r, ghistfig2g, nrow = 2)
ghistfig2r <- ggplot(subset(brghist1a, variable == "Reliability"), aes(x = t, y = value)) +
geom_line(aes(colour = tnow)) + coord_cartesian(xlim = c(0, 18), ylim = c(0, 1)) +
xlab(expression(t)) + ylab(expression(paste(R[sys]^(t[now]), (t)))) + guides(colour = 'none') +
scale_x_continuous(breaks = seq(0, 18, by = 2), minor_breaks = 0:18) +
scale_y_continuous(breaks = seq(0, 1, by = 0.2), minor_breaks = seq(0, 1, by = 0.1)) +
theme(axis.title = element_blank(), axis.text.x = element_blank(), axis.ticks.x = element_blank()) +
grid.arrange(ghistfig2r, ghistfig2g, nrow = 2)
ghistfig2r <- ggplot(subset(brghist1a, variable == "Reliability"), aes(x = t, y = value)) +
geom_line(aes(colour = tnow)) + coord_cartesian(xlim = c(0, 18), ylim = c(0, 1)) +
xlab(expression(t)) + ylab(expression(paste(R[sys]^(t[now]), (t)))) + guides(colour = 'none') +
scale_x_continuous(breaks = seq(0, 18, by = 2), minor_breaks = 0:18) +
scale_y_continuous(breaks = seq(0, 1, by = 0.2), minor_breaks = seq(0, 1, by = 0.1)) +
theme(axis.title = element_blank(), axis.text.x = element_blank(), axis.ticks.x = element_blank())
ghistfig2g <- ggplot(subset(brghist1a, variable == "Unit cost rate"), aes(x = t, y = value)) +
geom_line(aes(colour = tnow)) + coord_cartesian(xlim = c(0, 18), ylim = c(0, 3)) +
xlab(expression(t)) + ylab(expression(paste(g[sys]^(t[now]), (t)))) +
guides(colour=guide_legend(title=expression(t[now]))) +
theme(legend.position = 'bottom', legend.direction = 'horizontal') +
scale_x_continuous(breaks = seq(0, 18, by = 2), minor_breaks = 0:18) +
scale_y_continuous(breaks = seq(0, 3, by = 0.5), minor_breaks = seq(0, 3, by = 0.25))
grid.arrange(ghistfig2r, ghistfig2g, nrow = 2)
ghistfig2r <- ggplot(subset(brghist1a, variable == "Reliability"), aes(x = t, y = value)) +
geom_line(aes(colour = tnow)) + coord_cartesian(xlim = c(0, 18), ylim = c(0, 1)) +
xlab(expression(t)) + ylab(expression(paste(R[sys]^(t[now]), (t)))) + guides(colour = 'none') +
scale_x_continuous(breaks = seq(0, 18, by = 2), minor_breaks = 0:18) +
scale_y_continuous(breaks = seq(0, 1, by = 0.2), minor_breaks = seq(0, 1, by = 0.1)) +
theme(axis.title.x = element_blank(), axis.text.x = element_blank(), axis.ticks.x = element_blank())
grid.arrange(ghistfig2r, ghistfig2g, nrow = 2)
pdf("ghistfig2.pdf", width = 6, height = 3)
grid.arrange(ghistfig2r, ghistfig2g, nrow = 2)
dev.off()
pdf("ghistfig2.pdf", width = 6, height = 4)
grid.arrange(ghistfig2r, ghistfig2g, nrow = 2, heights = c(1, 1.2))
dev.off()
pdf("ghistfig2.pdf", width = 6, height = 4)
grid.arrange(ghistfig2r, ghistfig2g, nrow = 2, heights = c(1, 1.5))
dev.off()
library(actuar) # provides dinvgamma(x, shape, scale) where shape = alpha and scale = beta
library(ReliabilityTheory)
library(ggplot2)
library(reshape2)
library(gridExtra)
brmttf <- c(8, 2, 5, 3)
brn0 <- c(1, 1, 2, 1)
plotfts(brcompfts)
brcompfts2 <- list(C1 = NA, C2 = 1, C3 = 2, C4 = NA, H = 8,  M = NA, P1 = NA, P2 = 0.5, P3 = 1.5, P4 = NA)
plotfts(brcompfts2, 8)
brghist2 <- gnowhist(br, brctypes, brcompfts2, brn0y0, brbeta, seq(0, 8, by = 2), hor = 10, seqlen = 1001)
brghist2$tnow <- as.factor(brghist2$tnow)
brghist2a <- brghist2
names(brghist2a)[c(3,4)] <- c("Reliability", "Unit cost rate")
brghist2a <- melt(brghist2a, c("tnow", "t"))
brghist2a <- subset(brghist2a, !is.na(value))
ghist2fig1 <- ggplot(brghist2a, aes(x = t, y = value)) + coord_cartesian(ylim = c(0, 2.9)) +
geom_line(aes(colour = tnow, linetype = variable)) + xlab(expression(t)) +
#geom_line(aes(colour = tnow)) + xlab(expression(t)) + facet_wrap(~variable, nrow=2, scales = "free_y") +
ylab(expression(paste(g^(t[now]), (t), " and ", R[sys]^(t[now]), (t)))) +
#theme(legend.position = 'bottom', legend.direction = 'horizontal') +
guides(colour=guide_legend(title=expression(t[now])), linetype=guide_legend(title=NULL)) +
scale_x_continuous(breaks=seq(0, 18, by=2), minor_breaks=0:18)
ghist2fig1
brghist2 <- gnowhist(br, brctypes, brcompfts2, brn0y0, brbeta, seq(0, 2, by = 0.5), hor = 10, seqlen = 1001)
brghist2$tnow <- as.factor(brghist2$tnow)
brghist2a <- brghist2
names(brghist2a)[c(3,4)] <- c("Reliability", "Unit cost rate")
brghist2a <- melt(brghist2a, c("tnow", "t"))
brghist2a <- subset(brghist2a, !is.na(value))
ghist2fig1 <- ggplot(brghist2a, aes(x = t, y = value)) + coord_cartesian(ylim = c(0, 2.9)) +
geom_line(aes(colour = tnow, linetype = variable)) + xlab(expression(t)) +
#geom_line(aes(colour = tnow)) + xlab(expression(t)) + facet_wrap(~variable, nrow=2, scales = "free_y") +
ylab(expression(paste(g^(t[now]), (t), " and ", R[sys]^(t[now]), (t)))) +
#theme(legend.position = 'bottom', legend.direction = 'horizontal') +
guides(colour=guide_legend(title=expression(t[now])), linetype=guide_legend(title=NULL)) +
scale_x_continuous(breaks=seq(0, 18, by=2), minor_breaks=0:18)
ghist2fig1
ghist2fig1 <- ggplot(brghist2a, aes(x = t, y = value)) + coord_cartesian(ylim = c(0, 1.5)) +
geom_line(aes(colour = tnow, linetype = variable)) + xlab(expression(t)) +
#geom_line(aes(colour = tnow)) + xlab(expression(t)) + facet_wrap(~variable, nrow=2, scales = "free_y") +
ylab(expression(paste(g^(t[now]), (t), " and ", R[sys]^(t[now]), (t)))) +
#theme(legend.position = 'bottom', legend.direction = 'horizontal') +
guides(colour=guide_legend(title=expression(t[now])), linetype=guide_legend(title=NULL)) +
scale_x_continuous(breaks=seq(0, 18, by=2), minor_breaks=0:18)
ghist2fig1
pdf("ghist2fig1.pdf", width = 6, height = 3)
ghist2fig1
dev.off()
ghist2fig1 <- ggplot(brghist2a, aes(x = t, y = value)) + coord_cartesian(ylim = c(0, 1.25)) +
geom_line(aes(colour = tnow, linetype = variable)) + xlab(expression(t)) +
#geom_line(aes(colour = tnow)) + xlab(expression(t)) + facet_wrap(~variable, nrow=2, scales = "free_y") +
ylab(expression(paste(g^(t[now]), (t), " and ", R[sys]^(t[now]), (t)))) +
#theme(legend.position = 'bottom', legend.direction = 'horizontal') +
guides(colour=guide_legend(title=expression(t[now])), linetype=guide_legend(title=NULL)) +
scale_x_continuous(breaks=seq(0, 18, by=2), minor_breaks=0:18)
ghist2fig1
pdf("ghist2fig1.pdf", width = 6, height = 3)
ghist2fig1
dev.off()
brtaus2fine <- taustarhist(br, brctypes, brcompfts2, brn0y0, brbeta, seq(0, 2, by=0.1), hor=4, seqlen=401)
tauhist2fig2 <- ggplot(melt(brtaus2fine, "tnow"), aes(x = tnow, y = value)) + xlab(expression(t[now])) +
geom_line(aes(colour = variable, group = variable)) + ylab("") + guides(colour = guide_legend(title=NULL)) +
geom_point(aes(colour = variable, group = variable), size = 0.15) +
#  facet_grid(variable ~ ., scales = "free_y")
facet_wrap(~ variable, nrow = 2, scales = "free_y")
#  scale_x_continuous(breaks=seq(0, 8, by=2), minor_breaks=0:8)
tauhist2fig2
pdf("tauhist2fig2.pdf", width = 6, height = 4)
tauhist2fig2
dev.off()
brtaus2finepr <- taustarhist(br, brctypes, brcompfts2, brn0y0, brbeta, seq(0, 2, by=0.1), hor=4, seqlen=401, prior=T)
brtaus2prpo <- rbind(data.frame(melt(brtaus2fine, "tnow"), variable2 = "update"),
data.frame(melt(brtaus2finepr, "tnow"), variable2 = "no update"))
tauhist2fig3 <- ggplot(brtaus2prpo, aes(x = tnow, y = value)) + xlab(expression(t[now])) +
geom_line(aes(colour = variable2)) + ylab("") + guides(colour = guide_legend(title=NULL)) +
geom_point(aes(colour = variable2), size = 0.15) +
#  facet_grid(variable ~ ., scales = "free_y")
facet_wrap(~ variable, nrow = 2, scales = "free_y")
tauhist2fig3
pdf("tauhist2fig3.pdf", width = 6, height = 4)
tauhist2fig3
dev.off()
brmttf
brcompfts1
brcompfts
brcompfts1
brmttf
brcompfts3 <- list(C1 = NA, C2 = 10, C3 = 12, C4 = NA, H = 14,  M = NA, P1 = NA, P2 = 8, P3 = 9, P4 = NA)
plotfts(brcompfts3, 14)
brghist3 <- gnowhist(br, brctypes, brcompfts3, brn0y0, brbeta, seq(0, 14, by = 2), hor = 10, seqlen = 1001)
brghist3$tnow <- as.factor(brghist3$tnow)
brghist3a <- brghist3
names(brghist3a)[c(3,4)] <- c("Reliability", "Unit cost rate")
brghist3a <- melt(brghist3a, c("tnow", "t"))
brghist3a <- subset(brghist3a, !is.na(value))
ghist3fig1 <- ggplot(brghist3a, aes(x = t, y = value)) + coord_cartesian(ylim = c(0, 1.25)) +
geom_line(aes(colour = tnow, linetype = variable)) + xlab(expression(t)) +
#geom_line(aes(colour = tnow)) + xlab(expression(t)) + facet_wrap(~variable, nrow=2, scales = "free_y") +
ylab(expression(paste(g^(t[now]), (t), " and ", R[sys]^(t[now]), (t)))) +
#theme(legend.position = 'bottom', legend.direction = 'horizontal') +
guides(colour=guide_legend(title=expression(t[now])), linetype=guide_legend(title=NULL)) +
scale_x_continuous(breaks=seq(0, 18, by=2), minor_breaks=0:18)
ghist3fig1
ghist3fig1 <- ggplot(brghist3a, aes(x = t, y = value)) + #coord_cartesian(ylim = c(0, 1.25)) +
geom_line(aes(colour = tnow, linetype = variable)) + xlab(expression(t)) +
#geom_line(aes(colour = tnow)) + xlab(expression(t)) + facet_wrap(~variable, nrow=2, scales = "free_y") +
ylab(expression(paste(g^(t[now]), (t), " and ", R[sys]^(t[now]), (t)))) +
#theme(legend.position = 'bottom', legend.direction = 'horizontal') +
guides(colour=guide_legend(title=expression(t[now])), linetype=guide_legend(title=NULL)) +
scale_x_continuous(breaks=seq(0, 18, by=2), minor_breaks=0:18)
ghist3fig1
ghist3fig1 <- ggplot(brghist3a, aes(x = t, y = value)) + coord_cartesian(ylim = c(0, 2.5)) +
geom_line(aes(colour = tnow, linetype = variable)) + xlab(expression(t)) +
#geom_line(aes(colour = tnow)) + xlab(expression(t)) + facet_wrap(~variable, nrow=2, scales = "free_y") +
ylab(expression(paste(g^(t[now]), (t), " and ", R[sys]^(t[now]), (t)))) +
#theme(legend.position = 'bottom', legend.direction = 'horizontal') +
guides(colour=guide_legend(title=expression(t[now])), linetype=guide_legend(title=NULL)) +
scale_x_continuous(breaks=seq(0, 18, by=2), minor_breaks=0:18)
ghist3fig1
pdf("ghist3fig1.pdf", width = 6, height = 3)
ghist3fig1
dev.off()
ghist3fig1 <- ggplot(brghist3a, aes(x = t, y = value)) + coord_cartesian(ylim = c(0, 2.5)) +
geom_line(aes(colour = tnow, linetype = variable)) + xlab(expression(t)) +
#geom_line(aes(colour = tnow)) + xlab(expression(t)) + facet_wrap(~variable, nrow=2, scales = "free_y") +
ylab(expression(paste(g^(t[now]), (t), " and ", R[sys]^(t[now]), (t)))) +
#theme(legend.position = 'bottom', legend.direction = 'horizontal') +
guides(colour=guide_legend(title=expression(t[now])), linetype=guide_legend(title=NULL)) +
scale_x_continuous(breaks=seq(0, 24, by=2), minor_breaks=0:24)
ghist3fig1
pdf("ghist3fig1.pdf", width = 6, height = 3)
ghist3fig1
dev.off()
brtaus3fine <- taustarhist(br, brctypes, brcompfts3, brn0y0, brbeta, seq(0, 24, by=0.5), hor=4, seqlen=401)
tauhist3fig2 <- ggplot(melt(brtaus3fine, "tnow"), aes(x = tnow, y = value)) + xlab(expression(t[now])) +
geom_line(aes(colour = variable, group = variable)) + ylab("") + guides(colour = guide_legend(title=NULL)) +
geom_point(aes(colour = variable, group = variable), size = 0.15) +
#  facet_grid(variable ~ ., scales = "free_y")
facet_wrap(~ variable, nrow = 2, scales = "free_y")
tauhist3fig2
brcompfts3 <- list(C1 = NA, C2 = 10, C3 = 12, C4 = NA, H = 14,  M = NA, P1 = NA, P2 = 8, P3 = 9, P4 = NA)
plotfts(brcompfts3, 14)
tauhist3fig2
ghist3fig1
brtaus2fine <- taustarhist(br, brctypes, brcompfts2, brn0y0, brbeta, seq(0, 2, by=0.05), hor=4, seqlen=401)
tauhist2fig2 <- ggplot(melt(brtaus2fine, "tnow"), aes(x = tnow, y = value)) + xlab(expression(t[now])) +
geom_line(aes(colour = variable, group = variable)) + ylab("") + guides(colour = guide_legend(title=NULL)) +
geom_point(aes(colour = variable, group = variable), size = 0.15) +
#  facet_grid(variable ~ ., scales = "free_y")
facet_wrap(~ variable, nrow = 2, scales = "free_y")
tauhist2fig2
pdf("tauhist2fig2.pdf", width = 6, height = 4)
tauhist2fig2
dev.off()
brtaus2finepr <- taustarhist(br, brctypes, brcompfts2, brn0y0, brbeta, seq(0, 2, by=0.05), hor=4, seqlen=401, prior=T)
brtaus2prpo <- rbind(data.frame(melt(brtaus2fine, "tnow"), variable2 = "update"),
data.frame(melt(brtaus2finepr, "tnow"), variable2 = "no update"))
tauhist2fig3 <- ggplot(brtaus2prpo, aes(x = tnow, y = value)) + xlab(expression(t[now])) +
geom_line(aes(colour = variable2)) + ylab("") + guides(colour = guide_legend(title=NULL)) +
geom_point(aes(colour = variable2), size = 0.15) +
#  facet_grid(variable ~ ., scales = "free_y")
facet_wrap(~ variable, nrow = 2, scales = "free_y")
tauhist2fig3
pdf("tauhist2fig3.pdf", width = 6, height = 4)
tauhist2fig3
dev.off()
brtaus3fine <- taustarhist(br, brctypes, brcompfts3, brn0y0, brbeta, seq(0, 14, by=0.2), hor=4, seqlen=401)
brtaus3finepr <- taustarhist(br, brctypes, brcompfts3, brn0y0, brbeta, seq(0, 14, by=0.2), hor=4, seqlen=401, prior=T)
tauhist3fig2 <- ggplot(melt(brtaus3fine, "tnow"), aes(x = tnow, y = value)) + xlab(expression(t[now])) +
geom_line(aes(colour = variable, group = variable)) + ylab("") + guides(colour = guide_legend(title=NULL)) +
geom_point(aes(colour = variable, group = variable), size = 0.15) +
#  facet_grid(variable ~ ., scales = "free_y")
facet_wrap(~ variable, nrow = 2, scales = "free_y")
#  scale_x_continuous(breaks=seq(0, 8, by=2), minor_breaks=0:8)
tauhist3fig2
pdf("tauhist3fig2.pdf", width = 6, height = 4)
tauhist3fig2
dev.off()
brtaus3prpo <- rbind(data.frame(melt(brtaus3fine, "tnow"), variable2 = "update"),
data.frame(melt(brtaus3finepr, "tnow"), variable2 = "no update"))
tauhist3fig3 <- ggplot(brtaus2prpo, aes(x = tnow, y = value)) + xlab(expression(t[now])) +
geom_line(aes(colour = variable2)) + ylab("") + guides(colour = guide_legend(title=NULL)) +
geom_point(aes(colour = variable2), size = 0.15) +
#  facet_grid(variable ~ ., scales = "free_y")
facet_wrap(~ variable, nrow = 2, scales = "free_y")
tauhist3fig3
pdf("tauhist3fig3.pdf", width = 6, height = 4)
tauhist3fig3
dev.off()
tauhist3fig2 <- ggplot(melt(brtaus3fine, "tnow"), aes(x = tnow, y = value)) + xlab(expression(t[now])) +
geom_line(aes(colour = variable, group = variable)) + ylab("") + guides(colour = guide_legend(title=NULL)) +
geom_point(aes(colour = variable, group = variable), size = 0.15) +
#  facet_grid(variable ~ ., scales = "free_y")
facet_wrap(~ variable, nrow = 2, scales = "free_y")
#  scale_x_continuous(breaks=seq(0, 8, by=2), minor_breaks=0:8)
tauhist3fig2
pdf("tauhist3fig2.pdf", width = 6, height = 4)
tauhist3fig2
dev.off()
brtaus3prpo <- rbind(data.frame(melt(brtaus3fine, "tnow"), variable2 = "update"),
data.frame(melt(brtaus3finepr, "tnow"), variable2 = "no update"))
tauhist3fig3 <- ggplot(brtaus3prpo, aes(x = tnow, y = value)) + xlab(expression(t[now])) +
geom_line(aes(colour = variable2)) + ylab("") + guides(colour = guide_legend(title=NULL)) +
geom_point(aes(colour = variable2), size = 0.15) +
#  facet_grid(variable ~ ., scales = "free_y")
facet_wrap(~ variable, nrow = 2, scales = "free_y")
tauhist3fig3
pdf("tauhist3fig3.pdf", width = 6, height = 4)
tauhist3fig3
dev.off()
head(brhist1)
head(brghist1)
dim(brghist1)
table(brghist1$t)
head(brghist1)
table(brghist1$tnow)
cstars
taustarhist <- function(sys, ctypes, compfts, n0y0, beta, tnowvec, hor, seqlen = 101, prior = FALSE,
cu = 1, cp = 0.2, onecycle = TRUE){
res <- gnowhist(sys = sys, ctypes = ctypes, compfts = compfts, n0y0 = n0y0, beta = beta,
tnowvec = tnowvec, hor = hor, seqlen = seqlen, prior = prior, cu = cu, cp = cp, onecycle = onecycle)
res2 <- subset(res, !is.na(res$gnow))
cstars <- aggregate(gnow ~ tnow, res2, min)$gnow
tstarsi <- aggregate(gnow ~ tnow, res2, which.min)
tstarsi <- tstarsi$gnow + (seqlen - 1) * (0:(length(tnowvec) - 1))
tstars <- res2$t[tstarsi]
taustars <- tstars - tnowvec
cuint <- sapply(tnowvec, function(tnow){
trel <- subset(res, res$tnow == tnow)
f <- -diff(trel$rel)
tauvec <- trel$t[-1] # absolute timescale!
tau <- trel$t[which.min(trel$gnow)]
sum(f[tauvec <= tau] / tauvec[tauvec <= tau])
})
ctotal <- cp / tstars * res$rel[tstarsi] + cu * cuint
data.frame(tnow = tnowvec, taustar = taustars, tstar = tstars, cstar = cstars, ctotal = ctotal)
}
brtaus1 <- taustarhist(br, brctypes, brcompfts, brn0y0, brbeta, c(0,8), hor=2, seqlen=201)
head(brtaus1)
brtaus1 <- taustarhist(br, brctypes, brcompfts, brn0y0, brbeta, c(0:8), hor=2, seqlen=201)
ggplot(melt(brtaus1, "tnow"), aes(x = tnow, y = value)) + xlab(expression(t[now])) + ylab("") +
geom_line(aes(colour = variable, group = variable)) + guides(colour = guide_legend(title=NULL)) +
geom_point(aes(colour = variable, group = variable), size = 0.15) + facet_wrap(~ variable, nrow = 2, scales = "free_y")
brtaus1 <- taustarhist(br, brctypes, brcompfts, brn0y0, brbeta, seq(0, 8, by=0.25), hor=5, seqlen=501)
ggplot(melt(brtaus1, "tnow"), aes(x = tnow, y = value)) + xlab(expression(t[now])) + ylab("") +
geom_line(aes(colour = variable, group = variable)) + guides(colour = guide_legend(title=NULL)) +
geom_point(aes(colour = variable, group = variable), size = 0.15) + facet_wrap(~ variable, nrow = 2, scales = "free_y")
brtaus1fine <- taustarhist(br, brctypes, brcompfts, brn0y0, brbeta, seq(0,8,by=0.1), hor=4, seqlen=401)
tauhistfig1 <- ggplot(melt(brtaus1fine, "tnow"), aes(x = tnow, y = value)) + xlab(expression(t[now])) +
geom_line(aes(colour = variable, group = variable)) + ylab(element_blank()) +
geom_point(aes(colour = variable, group = variable), size = 0.5) + guides(colour = guide_legend(title=NULL)) +
scale_x_continuous(breaks=seq(0, 8, by=2), minor_breaks=0:8)
taustarhist <- function(sys, ctypes, compfts, n0y0, beta, tnowvec, hor, seqlen = 101, prior = FALSE,
cu = 1, cp = 0.2, onecycle = TRUE){
res <- gnowhist(sys = sys, ctypes = ctypes, compfts = compfts, n0y0 = n0y0, beta = beta,
tnowvec = tnowvec, hor = hor, seqlen = seqlen, prior = prior, cu = cu, cp = cp, onecycle = onecycle)
res2 <- subset(res, !is.na(res$gnow))
cstars <- aggregate(gnow ~ tnow, res2, min)$gnow
tstarsi <- aggregate(gnow ~ tnow, res2, which.min)
tstarsi <- tstarsi$gnow + (seqlen - 1) * (0:(length(tnowvec) - 1))
tstars <- res2$t[tstarsi]
taustars <- tstars - tnowvec
cuint <- sapply(tnowvec, function(tnow){
trel <- subset(res, res$tnow == tnow)
f <- -diff(trel$rel)
tauvec <- trel$t[-1] # absolute timescale!
tau <- trel$t[which.min(trel$gnow)]
sum(f[tauvec <= tau] / tauvec[tauvec <= tau])
})
ctotal <- cp / tstars * res2$rel[tstarsi] + cu * cuint
data.frame(tnow = tnowvec, taustar = taustars, tstar = tstars, cstar = cstars, ctotal = ctotal)
}
brtaus1 <- taustarhist(br, brctypes, brcompfts, brn0y0, brbeta, c(0,8), hor=2, seqlen=201)
ggplot(melt(brtaus1, "tnow"), aes(x = tnow, y = value)) + xlab(expression(t[now])) + ylab("") +
geom_line(aes(colour = variable, group = variable)) + guides(colour = guide_legend(title=NULL)) +
geom_point(aes(colour = variable, group = variable), size = 0.15) + facet_wrap(~ variable, nrow = 2, scales = "free_y")
brtaus1 <- taustarhist(br, brctypes, brcompfts, brn0y0, brbeta, seq(0, 8, by=0.25), hor=5, seqlen=501)
ggplot(melt(brtaus1, "tnow"), aes(x = tnow, y = value)) + xlab(expression(t[now])) + ylab("") +
geom_line(aes(colour = variable, group = variable)) + guides(colour = guide_legend(title=NULL)) +
geom_point(aes(colour = variable, group = variable), size = 0.15) + facet_wrap(~ variable, nrow = 2, scales = "free_y")
head(brtaus1)
taustarhist <- function(sys, ctypes, compfts, n0y0, beta, tnowvec, hor, seqlen = 101, prior = FALSE,
cu = 1, cp = 0.2, onecycle = TRUE){
res <- gnowhist(sys = sys, ctypes = ctypes, compfts = compfts, n0y0 = n0y0, beta = beta,
tnowvec = tnowvec, hor = hor, seqlen = seqlen, prior = prior, cu = cu, cp = cp, onecycle = onecycle)
res2 <- subset(res, !is.na(res$gnow))
cstars <- aggregate(gnow ~ tnow, res2, min)$gnow
tstarsi <- aggregate(gnow ~ tnow, res2, which.min)
tstarsi <- tstarsi$gnow + (seqlen - 1) * (0:(length(tnowvec) - 1))
tstars <- res2$t[tstarsi]
taustars <- tstars - tnowvec
cuint <- sapply(tnowvec, function(tnow){
trel <- subset(res, res$tnow == tnow)
f <- -diff(trel$rel)
tauvec <- trel$t[-1] # absolute timescale!
tau <- trel$t[which.min(trel$gnow)]
sum(f[tauvec <= tau] / tauvec[tauvec <= tau])
})
cat("cuint =", cuint)
ctotal <- cp / tstars * res2$rel[tstarsi] + cu * cuint
data.frame(tnow = tnowvec, taustar = taustars, tstar = tstars, cstar = cstars, ctotal = ctotal)
}
brtaus1 <- taustarhist(br, brctypes, brcompfts, brn0y0, brbeta, c(0,2,4,6,8), hor=10)
head(brtaus1)
brtaus1 <- taustarhist(br, brctypes, brcompfts, brn0y0, brbeta, c(0,2,4,6,8), hor=4, seqlen=401)
head(brtaus1)
brtaus1 <- taustarhist(br, brctypes, brcompfts, brn0y0, brbeta, c(0,2,4,6,8), hor=5, seqlen=501)
head(brtaus1)
brtaus1 <- taustarhist(br, brctypes, brcompfts, brn0y0, brbeta, c(0:8), hor=5, seqlen=501)
brtaus1 <- taustarhist(br, brctypes, brcompfts, brn0y0, brbeta, c(0:2), hor=5, seqlen=501)
0:8
c(0:8)
brtaus1 <- taustarhist(br, brctypes, brcompfts, brn0y0, brbeta, c(0,2), hor=5, seqlen=501)
brtaus1 <- taustarhist(br, brctypes, brcompfts, brn0y0, brbeta, 0:2, hor=5, seqlen=501)
taustarhist <- function(sys, ctypes, compfts, n0y0, beta, tnowvec, hor, seqlen = 101, prior = FALSE,
cu = 1, cp = 0.2, onecycle = TRUE){
res <- gnowhist(sys = sys, ctypes = ctypes, compfts = compfts, n0y0 = n0y0, beta = beta,
tnowvec = tnowvec, hor = hor, seqlen = seqlen, prior = prior, cu = cu, cp = cp, onecycle = onecycle)
res2 <- subset(res, !is.na(res$gnow))
cstars <- aggregate(gnow ~ tnow, res2, min)$gnow
tstarsi <- aggregate(gnow ~ tnow, res2, which.min)
tstarsi <- tstarsi$gnow + (seqlen - 1) * (0:(length(tnowvec) - 1))
tstars <- res2$t[tstarsi]
taustars <- tstars - tnowvec
cuint <- sapply(tnowvec, function(tnowi){
trel <- subset(res, res$tnow == tnowi)
f <- -diff(trel$rel)
tauvec <- trel$t[-1] # absolute timescale!
tau <- trel$t[which.min(trel$gnow)]
sum(f[tauvec <= tau] / tauvec[tauvec <= tau])
})
cat("cuint =", cuint)
ctotal <- cp / tstars * res2$rel[tstarsi] + cu * cuint
data.frame(tnow = tnowvec, taustar = taustars, tstar = tstars, cstar = cstars, ctotal = ctotal)
}
brtaus1 <- taustarhist(br, brctypes, brcompfts, brn0y0, brbeta, 0:2, hor=5, seqlen=501)
brtaus1 <- taustarhist(br, brctypes, brcompfts, brn0y0, brbeta, 0:8, hor=5, seqlen=501)
brtaus1 <- taustarhist(br, brctypes, brcompfts, brn0y0, brbeta, seq(0, 8, by=0.25), hor=5, seqlen=501)
ggplot(melt(brtaus1, "tnow"), aes(x = tnow, y = value)) + xlab(expression(t[now])) + ylab("") +
geom_line(aes(colour = variable, group = variable)) + guides(colour = guide_legend(title=NULL)) +
geom_point(aes(colour = variable, group = variable), size = 0.15) + facet_wrap(~ variable, nrow = 2, scales = "free_y")
brtaus1fine <- taustarhist(br, brctypes, brcompfts, brn0y0, brbeta, seq(0,8,by=0.1), hor=4, seqlen=401)
taustarhist <- function(sys, ctypes, compfts, n0y0, beta, tnowvec, hor, seqlen = 101, prior = FALSE,
cu = 1, cp = 0.2, onecycle = TRUE){
res <- gnowhist(sys = sys, ctypes = ctypes, compfts = compfts, n0y0 = n0y0, beta = beta,
tnowvec = tnowvec, hor = hor, seqlen = seqlen, prior = prior, cu = cu, cp = cp, onecycle = onecycle)
res2 <- subset(res, !is.na(res$gnow))
cstars <- aggregate(gnow ~ tnow, res2, min)$gnow
tstarsi <- aggregate(gnow ~ tnow, res2, which.min)
tstarsi <- tstarsi$gnow + (seqlen - 1) * (0:(length(tnowvec) - 1))
tstars <- res2$t[tstarsi]
taustars <- tstars - tnowvec
cuint <- sapply(tnowvec, function(tnowi){
trel <- subset(res, res$tnow == tnowi)
f <- -diff(trel$rel)
tauvec <- trel$t[-1] # absolute timescale!
tau <- trel$t[which.min(trel$gnow)]
sum(f[tauvec <= tau] / tauvec[tauvec <= tau])
})
#cat("cuint =", cuint)
ctotal <- cp / tstars * res2$rel[tstarsi] + cu * cuint
data.frame(tnow = tnowvec, taustar = taustars, tstar = tstars, cstar = cstars, ctotal = ctotal)
}
brtaus1fine <- taustarhist(br, brctypes, brcompfts, brn0y0, brbeta, seq(0,8,by=0.1), hor=4, seqlen=401)
tauhistfig1 <- ggplot(melt(brtaus1fine, "tnow"), aes(x = tnow, y = value)) + xlab(expression(t[now])) +
geom_line(aes(colour = variable, group = variable)) + ylab(element_blank()) +
geom_point(aes(colour = variable, group = variable), size = 0.5) + guides(colour = guide_legend(title=NULL)) +
scale_x_continuous(breaks=seq(0, 8, by=2), minor_breaks=0:8)
tauhistfig1
pdf("tauhistfig1.pdf", width = 6, height = 3)
tauhistfig1
dev.off()
tauhistfig2 <- ggplot(melt(brtaus1fine, "tnow"), aes(x = tnow, y = value)) + xlab(expression(t[now])) +
geom_line(aes(colour = variable, group = variable)) + ylab("") + guides(colour = guide_legend(title=NULL)) +
geom_point(aes(colour = variable, group = variable), size = 0.15) +
#  facet_grid(variable ~ ., scales = "free_y")
facet_wrap(~ variable, nrow = 2, scales = "free_y")
#  scale_x_continuous(breaks=seq(0, 8, by=2), minor_breaks=0:8)
tauhistfig2
pdf("tauhistfig2.pdf", width = 6, height = 4)
tauhistfig2
dev.off()
head(brtaus1fine)
brtaus1finepr <- taustarhist(br, brctypes, brcompfts, brn0y0, brbeta, seq(0,8,by=0.1), hor=4, seqlen=401, prior=T)
brtaus1prpo <- rbind(data.frame(melt(brtaus1fine, "tnow"), variable2 = "update"),
data.frame(melt(brtaus1finepr, "tnow"), variable2 = "no update"))
tauhistfig3 <- ggplot(brtaus1prpo, aes(x = tnow, y = value)) + xlab(expression(t[now])) +
geom_line(aes(colour = variable2)) + ylab("") + guides(colour = guide_legend(title=NULL)) +
geom_point(aes(colour = variable2), size = 0.15) +
#  facet_grid(variable ~ ., scales = "free_y")
facet_wrap(~ variable, nrow = 2, scales = "free_y")
tauhistfig3
pdf("tauhistfig3.pdf", width = 6, height = 4)
tauhistfig3
dev.off()
brtaus2fine <- taustarhist(br, brctypes, brcompfts2, brn0y0, brbeta, seq(0, 2, by=0.05), hor=4, seqlen=401)
tauhist2fig2 <- ggplot(melt(brtaus2fine, "tnow"), aes(x = tnow, y = value)) + xlab(expression(t[now])) +
geom_line(aes(colour = variable, group = variable)) + ylab("") + guides(colour = guide_legend(title=NULL)) +
geom_point(aes(colour = variable, group = variable), size = 0.15) +
#  facet_grid(variable ~ ., scales = "free_y")
facet_wrap(~ variable, nrow = 2, scales = "free_y")
tauhist2fig2
pdf("tauhist2fig2.pdf", width = 6, height = 4)
tauhist2fig2
dev.off()
brtaus2finepr <- taustarhist(br, brctypes, brcompfts2, brn0y0, brbeta, seq(0, 2, by=0.05), hor=4, seqlen=401, prior=T)
brtaus2prpo <- rbind(data.frame(melt(brtaus2fine, "tnow"), variable2 = "update"),
data.frame(melt(brtaus2finepr, "tnow"), variable2 = "no update"))
tauhist2fig3 <- ggplot(brtaus2prpo, aes(x = tnow, y = value)) + xlab(expression(t[now])) +
geom_line(aes(colour = variable2)) + ylab("") + guides(colour = guide_legend(title=NULL)) +
geom_point(aes(colour = variable2), size = 0.15) +
#  facet_grid(variable ~ ., scales = "free_y")
facet_wrap(~ variable, nrow = 2, scales = "free_y")
pdf("tauhist2fig3.pdf", width = 6, height = 4)
tauhist2fig3
dev.off()
brtaus3fine <- taustarhist(br, brctypes, brcompfts3, brn0y0, brbeta, seq(0, 14, by=0.2), hor=4, seqlen=401)
tauhist3fig2 <- ggplot(melt(brtaus3fine, "tnow"), aes(x = tnow, y = value)) + xlab(expression(t[now])) +
geom_line(aes(colour = variable, group = variable)) + ylab("") + guides(colour = guide_legend(title=NULL)) +
geom_point(aes(colour = variable, group = variable), size = 0.15) +
#  facet_grid(variable ~ ., scales = "free_y")
facet_wrap(~ variable, nrow = 2, scales = "free_y")
#  scale_x_continuous(breaks=seq(0, 8, by=2), minor_breaks=0:8)
pdf("tauhist3fig2.pdf", width = 6, height = 4)
tauhist3fig2
dev.off()
brtaus3finepr <- taustarhist(br, brctypes, brcompfts3, brn0y0, brbeta, seq(0, 14, by=0.2), hor=4, seqlen=401, prior=T)
brtaus3prpo <- rbind(data.frame(melt(brtaus3fine, "tnow"), variable2 = "update"),
data.frame(melt(brtaus3finepr, "tnow"), variable2 = "no update"))
tauhist3fig3 <- ggplot(brtaus3prpo, aes(x = tnow, y = value)) + xlab(expression(t[now])) +
geom_line(aes(colour = variable2)) + ylab("") + guides(colour = guide_legend(title=NULL)) +
geom_point(aes(colour = variable2), size = 0.15) +
#  facet_grid(variable ~ ., scales = "free_y")
facet_wrap(~ variable, nrow = 2, scales = "free_y")
pdf("tauhist3fig3.pdf", width = 6, height = 4)
tauhist3fig3
dev.off()
