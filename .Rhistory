table(brsimN5taudf$cycle)
brsimN5fig1 <- ggplot(brsimN5taudf, aes(x = tnow, y = taustar)) + geom_line(aes(colour = cycle, group = cycle)) +
xlab(expression(t[now])) + ylab(expression(paste(tau[ast]^(t[now]), (t[now])))) +
guides(colour = guide_legend(title="Cycle"))
brsimN5fig1
brsimN5taudf$cycle <- as.factor(brsimN5taudf$cycle)
brsimN5fig1 <- ggplot(brsimN5taudf, aes(x = tnow, y = taustar)) + geom_line(aes(colour = cycle, group = cycle)) +
xlab(expression(t[now])) + ylab(expression(paste(tau[ast]^(t[now]), (t[now])))) +
guides(colour = guide_legend(title="Cycle"))
brsimN5fig1
pdf("brsimN5fig1.pdf", width = 5, height = 3)
brsimN5fig1
dev.off()
brsimN5fig1 <- ggplot(brsimN5taudf, aes(x = tnow, y = taustar)) + geom_line(aes(colour = cycle, group = cycle)) +
xlab(expression(t[now])) + ylab(expression(paste(tau[as.symbol(*)]^(t[now]), (t[now])))) +
guides(colour = guide_legend(title="Cycle"))
brsimN5fig1 <- ggplot(brsimN5taudf, aes(x = tnow, y = taustar)) + geom_line(aes(colour = cycle, group = cycle)) +
xlab(expression(t[now])) + ylab(expression(paste(tau[as.name(*)]^(t[now]), (t[now])))) +
guides(colour = guide_legend(title="Cycle"))
brsimN5fig1 <- ggplot(brsimN5taudf, aes(x = tnow, y = taustar)) + geom_line(aes(colour = cycle, group = cycle)) +
xlab(expression(t[now])) + ylab(expression(paste(tau[\*]^(t[now]), (t[now])))) +
guides(colour = guide_legend(title="Cycle"))
brsimN5fig1 <- ggplot(brsimN5taudf, aes(x = tnow, y = taustar)) + geom_line(aes(colour = cycle, group = cycle)) +
xlab(expression(t[now])) + ylab(expression(paste(tau[asterisk]^(t[now]), (t[now])))) +
guides(colour = guide_legend(title="Cycle"))
pdf("brsimN5fig1.pdf", width = 5, height = 3)
brsimN5fig1
dev.off()
brsimN5fig1 <- ggplot(brsimN5taudf, aes(x = tnow, y = taustar)) + geom_line(aes(colour = cycle, group = cycle)) +
xlab(expression(t[now])) + ylab(expression(paste(tau["*"]^(t[now]), (t[now])))) +
guides(colour = guide_legend(title="Cycle"))
pdf("brsimN5fig1.pdf", width = 5, height = 3)
brsimN5fig1
dev.off()
source('~/work/weibull-papers/cbm-rbd/cbm-sim.R')
source('~/work/weibull-papers/cbm-rbd/cbm-sim.R')
brsimN5 <- simNcycle(sys = br, ctypes = brctypes, compfts = brcompftssim1, n0y0 = brn0y0, beta = brbeta,
tnowstep = 0.1, hor = 4, tprep = 0.5, trepa = 0, seqlen = 401)
source('~/work/weibull-papers/cbm-rbd/cbm-sim.R')
brsimN5 <- simNcycle(sys = br, ctypes = brctypes, compfts = brcompftssim1, n0y0 = brn0y0, beta = brbeta,
tnowstep = 0.1, hor = 4, tprep = 0.5, trepa = 0, seqlen = 401)
weighted.mean(brsimN5$costrate, brsimN5$tend)
brsimN5fig1 <- ggplot(brsimN5$res, aes(x = tnow, y = taustar)) + guides(colour = guide_legend(title="Cycle")) +
geom_line(aes(colour = cycle, group = cycle)) + geom_point(aes(colour = cycle, group = cycle)) +
xlab(expression(t[now])) + ylab(expression(paste(tau["*"]^(t[now]), (t[now]))))
pdf("brsimN5fig1.pdf", width = 5, height = 3)
brsimN5fig1
dev.off()
brsimN5fig1 <- ggplot(brsimN5$res, aes(x = tnow, y = taustar)) +
geom_line(aes(colour = cycle, group = cycle)) + geom_point(aes(colour = cycle, group = cycle)) +
xlab(expression(t[now])) + ylab(expression(paste(tau["*"]^(t[now]), (t[now])))) +
guides(colour = guide_legend(title="Cycle")) + scale_y_continuous(breaks=seq(0, 2, by=0.5), minor_breaks=seq(0, 2, by=0.25))
pdf("brsimN5fig1.pdf", width = 5, height = 3)
brsimN5fig1
dev.off()
sapply(brcompftssim1, function(x) x[2])
sort(sapply(brcompftssim1, function(x) x[2]))
sort(sapply(brcompftssim1, function(x) x[1]))
sort(sapply(brcompftssim1, function(x) x[3]))
sort(sapply(brcompftssim1, function(x) x[4]))
sort(sapply(brcompftssim1, function(x) x[5]))
brWeibullData <- function(ncycles, beta, mttf){
C1sim1 <- rweibull(ncycles, shape = beta[1], scale = (failuretolambda(mttf[1], beta[1]))^(1/beta[1]))
C2sim1 <- rweibull(ncycles, shape = beta[1], scale = (failuretolambda(mttf[1], beta[1]))^(1/beta[1]))
C3sim1 <- rweibull(ncycles, shape = beta[1], scale = (failuretolambda(mttf[1], beta[1]))^(1/beta[1]))
C4sim1 <- rweibull(ncycles, shape = beta[1], scale = (failuretolambda(mttf[1], beta[1]))^(1/beta[1]))
Hsim1  <- rweibull(ncycles, shape = beta[2], scale = (failuretolambda(mttf[2], beta[2]))^(1/beta[2]))
Msim1  <- rweibull(ncycles, shape = beta[3], scale = (failuretolambda(mttf[3], beta[3]))^(1/beta[3]))
P1sim1 <- rweibull(ncycles, shape = beta[4], scale = (failuretolambda(mttf[4], beta[4]))^(1/beta[4]))
P2sim1 <- rweibull(ncycles, shape = beta[4], scale = (failuretolambda(mttf[4], beta[4]))^(1/beta[4]))
P3sim1 <- rweibull(ncycles, shape = beta[4], scale = (failuretolambda(mttf[4], beta[4]))^(1/beta[4]))
P4sim1 <- rweibull(ncycles, shape = beta[4], scale = (failuretolambda(mttf[4], beta[4]))^(1/beta[4]))
list(C1 = C1sim1, C2 = C2sim1, C3 = C3sim1, C4 = C4sim1, H = Hsim1,
M = Msim1, P1 = P1sim1, P2 = P2sim1, P3 = P3sim1, P4 = P4sim1)
}
set.seed(1328)
brcompftssim1 <- brWeibullData(5, brbeta, brmttf)
sort(sapply(brcompftssim1, function(x) x[1]))
sort(sapply(brcompftssim1, function(x) x[2]))
brsimN51 <- brsimN5
weighted.mean(brsimN51$costrate, brsimN51$tend)
brsimN51fig1 <- ggplot(brsimN51$res, aes(x = tnow, y = taustar)) +
geom_line(aes(colour = cycle, group = cycle)) + geom_point(aes(colour = cycle, group = cycle)) +
xlab(expression(t[now])) + ylab(expression(paste(tau["*"]^(t[now]), (t[now])))) +
guides(colour = guide_legend(title="Cycle")) + scale_y_continuous(breaks=seq(0, 2, by=0.5), minor_breaks=seq(0, 2, by=0.25))
pdf("brsimN51fig1.pdf", width = 5, height = 3)
brsimN51fig1
dev.off()
sort(sapply(brcompftssim1, function(x) x[1]))
set.seed(1328)
brcompftssim1 <- brWeibullData(5, brbeta, brmttf)
brcompftssim2 <- brWeibullData(5, brbeta, brmttf)
brsimN52 <- simNcycle(sys = br, ctypes = brctypes, compfts = brcompftssim2, n0y0 = brn0y0, beta = brbeta,
tnowstep = 0.1, hor = 4, tprep = 0.5, trepa = 0, seqlen = 401)
brsimN52$downtime; brsimN52$tend; brsimN52$costrate
weighted.mean(brsimN52$costrate, brsimN52$tend)
brsimN52fig1 <- ggplot(brsimN52$res, aes(x = tnow, y = taustar)) +
geom_line(aes(colour = cycle, group = cycle)) + geom_point(aes(colour = cycle, group = cycle)) +
xlab(expression(t[now])) + ylab(expression(paste(tau["*"]^(t[now]), (t[now])))) +
guides(colour = guide_legend(title="Cycle")) + scale_y_continuous(breaks=seq(0, 2, by=0.5), minor_breaks=seq(0, 2, by=0.25))
pdf("brsimN52fig1.pdf", width = 5, height = 3)
brsimN52fig1
dev.off()
sort(sapply(brcompftssim1, function(x) x[1]))
sort(sapply(brcompftssim2, function(x) x[1]))
sort(sapply(brcompftssim2, function(x) x[2]))
sort(sapply(brcompftssim2, function(x) x[3]))
sort(sapply(brcompftssim2, function(x) x[4]))
sort(sapply(brcompftssim2, function(x) x[5]))
library(actuar) # provides dinvgamma(x, shape, scale) where shape = alpha and scale = beta
library(ReliabilityTheory)
library(ggplot2)
library(reshape2)
library(gridExtra)
set.seed(1328)
brcompftssim1 <- brWeibullData(5, brbeta, brmttf)
brcompftssim2 <- brWeibullData(5, brbeta, brmttf)
brcompftssim3 <- brWeibullData(5, brbeta, brmttf)
brsimN53 <- simNcycle(sys = br, ctypes = brctypes, compfts = brcompftssim3, n0y0 = brn0y0, beta = brbeta,
tnowstep = 0.1, hor = 4, tprep = 0.5, trepa = 0, seqlen = 401)
brsimN53$downtime; brsimN53$tend; brsimN53$costrate
weighted.mean(brsimN53$costrate, brsimN53$tend)
head(brsimN53$res)
head(brghist1)
brghist1[120:125,]
brghist1[124:129,]
brsimN51$downtime; brsimN51$tend; brsimN51$costrate
weighted.mean(brsimN51$costrate, brsimN51$tend)
0.2 / 1.27
5*1.27
sum(brsimN51$tend)
brsimN53$downtime; brsimN53$tend; brsimN53$costrate
weighted.mean(brsimN53$costrate, brsimN53$tend)
brsimN53fig1 <- ggplot(brsimN53$res, aes(x = tnow, y = taustar)) +
geom_line(aes(colour = cycle, group = cycle)) + geom_point(aes(colour = cycle, group = cycle)) +
xlab(expression(t[now])) + ylab(expression(paste(tau["*"]^(t[now]), (t[now])))) +
guides(colour = guide_legend(title="Cycle")) + scale_y_continuous(breaks=seq(0, 2, by=0.5), minor_breaks=seq(0, 2, by=0.25))
pdf("brsimN53fig1.pdf", width = 5, height = 3)
brsimN53fig1
dev.off()
?repeat
)
?repeat()
?"repeat"
library(actuar) # provides dinvgamma(x, shape, scale) where shape = alpha and scale = beta
library(ReliabilityTheory)
library(ggplot2)
library(reshape2)
library(gridExtra)
set.seed(2211)
brsim5cycle20data <- list()
for (i in 1:20){
brsim5cycle20data[[i]] <- brWeibullData(5, brbeta, brmttf)
}
brsim5cycle20 <- list()
for (i in 1:20){
brsim5cycle20[[i]] <- simNcycle(sys = br, ctypes = brctypes, compfts = brsim5cycle20data[[i]], n0y0 = brn0y0,
beta = brbeta, tnowstep = 0.1, hor = 4, tprep = 0.5, trepa = 0, seqlen = 401)
}
brsim5cycle20[[20]]$downtime
brsim5cycle20[[1]]$downtime
brsim5cycle20[[2]]$downtime
brsim5cycle20[[3]]$downtime
brsim5cycle20[[4]]$downtime
sapply(brsim5cycle20, function(res) sum(res$downtime)
)
sapply(brsim5cycle20, function(res) sum(res$tend))
sapply(brsim5cycle20, function(res) weighted.mean(res$costrate, res$tend))
brsim5cycle20summary <- data.frame(id = 1:20,
downtime = sapply(brsim5cycle20, function(res) sum(res$downtime)),
sumtend = sapply(brsim5cycle20, function(res) sum(res$tend)),
meancostrate = sapply(brsim5cycle20, function(res) weighted.mean(res$costrate, res$tend)))
brsim5cycle20summary
brsim5cycle20summary <- data.frame(id = 1:20,
downtime = sapply(brsim5cycle20, function(res) sum(res$downtime)),
meantend = sapply(brsim5cycle20, function(res) mean(res$tend)),
meancostrate = sapply(brsim5cycle20, function(res) weighted.mean(res$costrate, res$tend)))
head(melt(brsim5cycle20summary, id))
head(melt(brsim5cycle20summary, "id"))
brsim5cycle20fig1 <- ggplot(melt(brsim5cycle20summary, "id"), aes(x = id, y = value)) +
geom_line(aes(colour = variable, group = variable)) + geom_point(aes(colour = variable, group = variable))
brsim5cycle20fig1
source("weibull-sys-functions.R")
source("cbm-sim.R")
source("plotdefs.R")
br <- graph.formula(s -- M -- C1:C2:C3:C4, P1:P2:P3:P4 -- t,
C1 -- P1, C2 -- P2, C3 -- P3, C4 -- P4, s -- H -- P3:P4)
brctypes <- list("C"=c("C1", "C2", "C3", "C4"), "H"=c("H"), "M"=c("M"), "P"=c("P1", "P2", "P3", "P4"))
br <- setCompTypes(br, brctypes)
brsysign <- computeSystemSurvivalSignature(br)
brobeta <- c(2, 1.2, 2.5, 1.5)
bromttf <- c(5, 10, 8, 3)
bron0 <- c(1, 1, 1, 1) # weak prior
bron0y0 <- list(C=c(bron0[1], failuretolambda(bromttf[1], brobeta[1])),
H=c(bron0[2], failuretolambda(bromttf[2], brobeta[2])),
M=c(bron0[3], failuretolambda(bromttf[3], brobeta[3])),
P=c(bron0[4], failuretolambda(bromttf[4], brobeta[4])))
brfts0 <- list(C=NULL, H=NULL, M=NULL, P=NULL)
comphor <- 10; complen <- 201
onecomp <- graph.formula(s -- 1 -- t)
Ccomp <- setCompTypes(onecomp, list(C = "1"))
Hcomp <- setCompTypes(onecomp, list(H = "1"))
Mcomp <- setCompTypes(onecomp, list(M = "1"))
Pcomp <- setCompTypes(onecomp, list(P = "1"))
Crel1 <- sysrelnowhor(computeSystemSurvivalSignature(Ccomp), br1n0y0[1], br1beta[1], brfts0[1],
tnow = 0, hor = comphor, seqlen = complen)
Hrel1 <- sysrelnowhor(computeSystemSurvivalSignature(Hcomp), br1n0y0[2], br1beta[2], brfts0[2],
tnow = 0, hor = comphor, seqlen = complen)
Mrel1 <- sysrelnowhor(computeSystemSurvivalSignature(Mcomp), br1n0y0[3], br1beta[3], brfts0[3],
tnow = 0, hor = comphor, seqlen = complen)
Prel1 <- sysrelnowhor(computeSystemSurvivalSignature(Pcomp), br1n0y0[4], br1beta[4], brfts0[4],
tnow = 0, hor = comphor, seqlen = complen)
compdf1 <- rbind(data.frame(Crel1, comp = "C"), data.frame(Hrel1, comp = "H"),
data.frame(Mrel1, comp = "M"), data.frame(Prel1, comp = "P"))
br1beta <- c(2, 1.2, 2.5, 1.5)
br1mttf <- c(5, 10, 8, 3)
br1n0 <- c(1, 1, 1, 1) # weak prior
br1n0y0 <- list(C=c(br1n0[1], failuretolambda(br1mttf[1], br1beta[1])),
H=c(br1n0[2], failuretolambda(br1mttf[2], br1beta[2])),
M=c(br1n0[3], failuretolambda(br1mttf[3], br1beta[3])),
P=c(br1n0[4], failuretolambda(br1mttf[4], br1beta[4])))
brfts0 <- list(C=NULL, H=NULL, M=NULL, P=NULL)
comphor <- 10; complen <- 201
onecomp <- graph.formula(s -- 1 -- t)
Ccomp <- setCompTypes(onecomp, list(C = "1"))
Hcomp <- setCompTypes(onecomp, list(H = "1"))
Mcomp <- setCompTypes(onecomp, list(M = "1"))
Pcomp <- setCompTypes(onecomp, list(P = "1"))
Crel1 <- sysrelnowhor(computeSystemSurvivalSignature(Ccomp), br1n0y0[1], br1beta[1], brfts0[1],
tnow = 0, hor = comphor, seqlen = complen)
Hrel1 <- sysrelnowhor(computeSystemSurvivalSignature(Hcomp), br1n0y0[2], br1beta[2], brfts0[2],
tnow = 0, hor = comphor, seqlen = complen)
Mrel1 <- sysrelnowhor(computeSystemSurvivalSignature(Mcomp), br1n0y0[3], br1beta[3], brfts0[3],
tnow = 0, hor = comphor, seqlen = complen)
Prel1 <- sysrelnowhor(computeSystemSurvivalSignature(Pcomp), br1n0y0[4], br1beta[4], brfts0[4],
tnow = 0, hor = comphor, seqlen = complen)
compdf1 <- rbind(data.frame(Crel1, comp = "C"), data.frame(Hrel1, comp = "H"),
data.frame(Mrel1, comp = "M"), data.frame(Prel1, comp = "P"))
compprior1fig1 <- ggplot(compdf1, aes(x = t, y = rel)) + geom_line(aes(group = comp)) +
ylab("Reliability") + scale_x_continuous(breaks=seq(0, 10, by=2), minor_breaks=0:10) +
facet_wrap(~ comp, nrow = 2, scales = "free_y") + coord_cartesian(ylim = c(0, 1))
compprior1fig1
br1beta <- c(2, 1.2, 2.5, 1.5)
br1mttf <- c(3, 10, 8, 5)
br1n0 <- c(1, 1, 1, 1) # weak prior
br1n0y0 <- list(C=c(br1n0[1], failuretolambda(br1mttf[1], br1beta[1])),
H=c(br1n0[2], failuretolambda(br1mttf[2], br1beta[2])),
M=c(br1n0[3], failuretolambda(br1mttf[3], br1beta[3])),
P=c(br1n0[4], failuretolambda(br1mttf[4], br1beta[4])))
brfts0 <- list(C=NULL, H=NULL, M=NULL, P=NULL)
Crel1 <- sysrelnowhor(computeSystemSurvivalSignature(Ccomp), br1n0y0[1], br1beta[1], brfts0[1],
tnow = 0, hor = comphor, seqlen = complen)
Hrel1 <- sysrelnowhor(computeSystemSurvivalSignature(Hcomp), br1n0y0[2], br1beta[2], brfts0[2],
tnow = 0, hor = comphor, seqlen = complen)
Mrel1 <- sysrelnowhor(computeSystemSurvivalSignature(Mcomp), br1n0y0[3], br1beta[3], brfts0[3],
tnow = 0, hor = comphor, seqlen = complen)
Prel1 <- sysrelnowhor(computeSystemSurvivalSignature(Pcomp), br1n0y0[4], br1beta[4], brfts0[4],
tnow = 0, hor = comphor, seqlen = complen)
compdf1 <- rbind(data.frame(Crel1, comp = "C"), data.frame(Hrel1, comp = "H"),
data.frame(Mrel1, comp = "M"), data.frame(Prel1, comp = "P"))
compprior1fig1 <- ggplot(compdf1, aes(x = t, y = rel)) + geom_line(aes(group = comp)) +
ylab("Reliability") + scale_x_continuous(breaks=seq(0, 10, by=2), minor_breaks=0:10) +
facet_wrap(~ comp, nrow = 2, scales = "free_y") + coord_cartesian(ylim = c(0, 1))
compprior1fig1
pdf("compprior1fig1.pdf", width = 6, height = 4)
compprior1fig1
dev.off()
compprior1fig2 <- ggplot(compdf1, aes(x = t, y = rel)) + geom_line(aes(linetype = comp)) +
ylab("Reliability") + scale_x_continuous(breaks=seq(0, 10, by=2), minor_breaks=0:10) +
guides(linetype = guide_legend(title=NULL)) + coord_cartesian(ylim = c(0, 1))
compprior1fig2
pdf("compprior1fig2.pdf", width = 6, height = 4)
compprior1fig2
dev.off()
br1beta <- c(2, 1, 2.5, 1.5)
br1mttf <- c(3, 10, 8, 5)
br1n0 <- c(1, 1, 1, 1) # weak prior
br1n0y0 <- list(C=c(br1n0[1], failuretolambda(br1mttf[1], br1beta[1])),
H=c(br1n0[2], failuretolambda(br1mttf[2], br1beta[2])),
M=c(br1n0[3], failuretolambda(br1mttf[3], br1beta[3])),
P=c(br1n0[4], failuretolambda(br1mttf[4], br1beta[4])))
Crel1 <- sysrelnowhor(computeSystemSurvivalSignature(Ccomp), br1n0y0[1], br1beta[1], brfts0[1],
tnow = 0, hor = comphor, seqlen = complen)
Hrel1 <- sysrelnowhor(computeSystemSurvivalSignature(Hcomp), br1n0y0[2], br1beta[2], brfts0[2],
tnow = 0, hor = comphor, seqlen = complen)
Mrel1 <- sysrelnowhor(computeSystemSurvivalSignature(Mcomp), br1n0y0[3], br1beta[3], brfts0[3],
tnow = 0, hor = comphor, seqlen = complen)
Prel1 <- sysrelnowhor(computeSystemSurvivalSignature(Pcomp), br1n0y0[4], br1beta[4], brfts0[4],
tnow = 0, hor = comphor, seqlen = complen)
compdf1 <- rbind(data.frame(Crel1, comp = "C"), data.frame(Hrel1, comp = "H"),
data.frame(Mrel1, comp = "M"), data.frame(Prel1, comp = "P"))
compprior1fig1 <- ggplot(compdf1, aes(x = t, y = rel)) + geom_line(aes(group = comp)) +
ylab("Reliability") + scale_x_continuous(breaks=seq(0, 10, by=2), minor_breaks=0:10) +
facet_wrap(~ comp, nrow = 2, scales = "free_y") + coord_cartesian(ylim = c(0, 1))
pdf("compprior1fig1.pdf", width = 6, height = 4)
compprior1fig1
dev.off()
compprior1fig2 <- ggplot(compdf1, aes(x = t, y = rel)) + geom_line(aes(linetype = comp)) +
ylab("Reliability") + scale_x_continuous(breaks=seq(0, 10, by=2), minor_breaks=0:10) +
guides(linetype = guide_legend(title=NULL)) + coord_cartesian(ylim = c(0, 1))
pdf("compprior1fig2.pdf", width = 6, height = 4)
compprior1fig2
dev.off()
failuretolambda(br1mttf[1], br1beta[1])
failuretolambda(br1mttf[2], br1beta[2])
failuretolambda(br1mttf[3], br1beta[3])
failuretolambda(br1mttf[4], br1beta[4])
brcompfts <- list(C1 = NA, C2 = 6, C3 = 7, C4 = NA, H = 8,  M = NA, P1 = NA, P2 = 3, P3 = 4, P4 = NA)
brfstdf <- compfts2df(brcompfts)
plotfts(brcompfts)
br1ghist1 <- gnowhist(br, brctypes, brcompfts, br1n0y0, br1beta, c(0,2,4,6,8), hor = 10, seqlen = 1001)
br1ghist1$tnow <- as.factor(br1ghist1$tnow)
br1ghist1a <- br1ghist1
names(br1ghist1a)[c(3,4)] <- c("Reliability", "Unit cost rate")
br1ghist1a <- melt(br1ghist1a, c("tnow", "t"))
br1ghist1a <- subset(br1ghist1a, !is.na(value))
ghist1fig2r <- ggplot(subset(br1ghist1a, variable == "Reliability"), aes(x = t, y = value)) +
geom_line(aes(colour = tnow)) + coord_cartesian(xlim = c(0, 18), ylim = c(0, 1)) +
xlab(expression(t)) + ylab(expression(paste(R[sys]^(t[now]), (t)))) + guides(colour = 'none') +
scale_x_continuous(breaks = seq(0, 18, by = 2), minor_breaks = 0:18) +
scale_y_continuous(breaks = seq(0, 1, by = 0.2), minor_breaks = seq(0, 1, by = 0.1)) +
theme(axis.title.x = element_blank(), axis.text.x = element_blank(), axis.ticks.x = element_blank())
ghist1fig2g <- ggplot(subset(br1ghist1a, variable == "Unit cost rate"), aes(x = t, y = value)) +
geom_line(aes(colour = tnow)) + coord_cartesian(xlim = c(0, 18), ylim = c(0, 3)) +
xlab(expression(t)) + ylab(expression(paste(g[sys]^(t[now]), (t)))) +
guides(colour=guide_legend(title=expression(t[now]))) +
theme(legend.position = 'bottom', legend.direction = 'horizontal') +
scale_x_continuous(breaks = seq(0, 18, by = 2), minor_breaks = 0:18) +
scale_y_continuous(breaks = seq(0, 3, by = 0.5), minor_breaks = seq(0, 3, by = 0.25))
pdf("ghist1fig2.pdf", width = 6, height = 4)
grid.arrange(ghist1fig2r, ghist1fig2g, nrow = 2, heights = c(1, 1.5))
dev.off()
ghist1fig2g <- ggplot(subset(br1ghist1a, variable == "Unit cost rate"), aes(x = t, y = value)) +
geom_line(aes(colour = tnow)) + coord_cartesian(xlim = c(0, 18), ylim = c(0, 2.2)) +
xlab(expression(t)) + ylab(expression(paste(g[sys]^(t[now]), (t)))) +
guides(colour=guide_legend(title=expression(t[now]))) +
theme(legend.position = 'bottom', legend.direction = 'horizontal') +
scale_x_continuous(breaks = seq(0, 18, by = 2), minor_breaks = 0:18) +
scale_y_continuous(breaks = seq(0, 3, by = 0.5), minor_breaks = seq(0, 3, by = 0.25))
pdf("ghist1fig2.pdf", width = 6, height = 4)
grid.arrange(ghist1fig2r, ghist1fig2g, nrow = 2, heights = c(1, 1.5))
dev.off()
br1taus1fine <- taustarhist(br, brctypes, brcompfts, br1n0y0, br1beta, seq(0,8,by=0.1), hor=4, seqlen=401)
tauhist1fig2 <- ggplot(melt(br1taus1fine, "tnow"), aes(x = tnow, y = value)) + xlab(expression(t[now])) +
geom_line(aes(colour = variable, group = variable)) + ylab("") + guides(colour = guide_legend(title=NULL)) +
geom_point(aes(colour = variable, group = variable), size = 0.15) +
facet_wrap(~ variable, nrow = 2, scales = "free_y")
tauhist1fig2 <- ggplot(melt(br1taus1fine, "tnow"), aes(x = tnow, y = value)) + xlab(expression(t[now])) +
geom_line(aes(colour = variable, group = variable)) + ylab("") + guides(colour = guide_legend(title=NULL)) +
geom_point(aes(colour = variable, group = variable), size = 0.15) +
facet_wrap(~ variable, nrow = 2, scales = "free_y")
pdf("tauhist1fig2.pdf", width = 6, height = 4)
tauhist1fig2
dev.off()
br1taus1finepr <- taustarhist(br, brctypes, brcompfts, br1n0y0, br1beta, seq(0,8,by=0.1), hor=4, seqlen=401, prior=T)
br1taus1prpo <- rbind(data.frame(melt(br1taus1fine, "tnow"), variable2 = "update"),
data.frame(melt(br1taus1finepr, "tnow"), variable2 = "no update"))
tauhist1fig3 <- ggplot(br1taus1prpo, aes(x = tnow, y = value)) + xlab(expression(t[now])) +
geom_line(aes(colour = variable2)) + ylab("") + guides(colour = guide_legend(title=NULL)) +
geom_point(aes(colour = variable2), size = 0.15) +
facet_wrap(~ variable, nrow = 2, scales = "free_y")
pdf("tauhist1fig3.pdf", width = 6, height = 4)
tauhist1fig3
dev.off()
head(br1taus1fine)
subset(br1taus1fine, tnow == 3.9 | tnow == 4)
subset(br1taus1fine, (tnow == 3.9 | tnow == 4))
subset(br1taus1fine, tnow == 3.9)
br1taus1fine[40:41]
br1taus1fine[40:41,]
brcompfts2 <- list(C1 = NA, C2 = 1, C3 = 2, C4 = NA, H = 8,  M = NA, P1 = NA, P2 = 0.5, P3 = 1.5, P4 = NA)
br1taus2fine <- taustarhist(br, brctypes, brcompfts2, br1n0y0, br1beta, seq(0, 2, by=0.05), hor=4, seqlen=401)
br1taus2finepr <- taustarhist(br, brctypes, brcompfts2, br1n0y0, br1beta, seq(0, 2, by=0.05), hor=4, seqlen=401, prior=T)
br1taus2prpo <- rbind(data.frame(melt(br1taus2fine, "tnow"), variable2 = "update"),
data.frame(melt(br1taus2finepr, "tnow"), variable2 = "no update"))
tauhist2fig3 <- ggplot(br1taus2prpo, aes(x = tnow, y = value)) + xlab(expression(t[now])) +
geom_line(aes(colour = variable2)) + ylab("") + guides(colour = guide_legend(title=NULL)) +
geom_point(aes(colour = variable2), size = 0.15) +
facet_wrap(~ variable, nrow = 2, scales = "free_y")
pdf("tauhist2fig3.pdf", width = 6, height = 4)
tauhist2fig3
dev.off()
brcompfts3 <- list(C1 = NA, C2 = 10, C3 = 12, C4 = NA, H = 14,  M = NA, P1 = NA, P2 = 8, P3 = 9, P4 = NA)
br1taus3fine <- taustarhist(br, brctypes, brcompfts3, br1n0y0, br1beta, seq(0, 14, by=0.2), hor=4, seqlen=401)
br1taus3finepr <- taustarhist(br, brctypes, brcompfts3, br1n0y0, br1beta, seq(0, 14, by=0.2), hor=4, seqlen=401, prior=T)
br1taus3prpo <- rbind(data.frame(melt(br1taus3fine, "tnow"), variable2 = "update"),
data.frame(melt(br1taus3finepr, "tnow"), variable2 = "no update"))
tauhist3fig3 <- ggplot(br1taus3prpo, aes(x = tnow, y = value)) + xlab(expression(t[now])) +
geom_line(aes(colour = variable2)) + ylab("") + guides(colour = guide_legend(title=NULL)) +
geom_point(aes(colour = variable2), size = 0.15) +
facet_wrap(~ variable, nrow = 2, scales = "free_y")
pdf("tauhist3fig3.pdf", width = 6, height = 4)
tauhist3fig3
dev.off()
set.seed(2211)
br1sim5cycle20data <- list()
for (i in 1:20){
br1sim5cycle20data[[i]] <- brWeibullData(5, br1beta, br1mttf)
}
br1sim5cycle20 <- list()
br1sim5cycle20fig1
brsim5cycle20fig1
for (i in 1:20){
br1sim5cycle20[[i]] <- simNcycle(sys = br, ctypes = brctypes, compfts = br1sim5cycle20data[[i]], n0y0 = br1n0y0,
beta = br1beta, tnowstep = 0.1, hor = 4, tprep = 0.5, trepa = 0, seqlen = 401)
}
tfunc <- max(res$tnow[!res$failed])
source('~/work/weibull-papers/cbm-rbd/cbm-sim.R')
br1simN51 <- simNcycle(sys = br, ctypes = brctypes, compfts = br1sim5cycle20data[[1]], n0y0 = br1n0y0, beta = br1beta,
tnowstep = 0.1, hor = 4, tprep = 0.5, trepa = 0, seqlen = 401)
br1simN51 <- simNcycle(sys = br, ctypes = brctypes, compfts = br1sim5cycle20data[[1]], n0y0 = br1n0y0, beta = br1beta,
tnowstep = 0.1, hor = 4, tprep = 0.5, trepa = 0, seqlen = 401)
br1simN51fig1 <- ggplot(br1simN51$res, aes(x = tnow, y = taustar)) +
geom_line(aes(colour = cycle, group = cycle)) + geom_point(aes(colour = cycle, group = cycle)) +
xlab(expression(t[now])) + ylab(expression(paste(tau["*"]^(t[now]), (t[now])))) +
guides(colour = guide_legend(title="Cycle")) + scale_y_continuous(breaks=seq(0, 2, by=0.5), minor_breaks=seq(0, 2, by=0.25))
pdf("br1simN51fig1.pdf", width = 6, height = 4)
br1simN51fig1
dev.off()
source('~/work/weibull-papers/cbm-rbd/cbm-sim-prep.R')
asdf <- graph.formula(s -- A -- t)
asdf <- setCompTypes(asdf, list(A = A))
asdf <- setCompTypes(asdf, list("A" = "A"))
computeSystemSurvivalSignature(asdf)
asdf <- induced_subgraph(asdf, vids=V(asd)[!(name %in% "A")])
asdf <- induced_subgraph(asdf, vids=V(asdf)[!(name %in% "A")])
asdf
plot(asdf)
computeSystemSurvivalSignature(asdf)
?induced_subgraph
distances(asdf, "s", "t")
asdf <- graph.formula(s -- A -- t)
asdf <- setCompTypes(asdf, list("A" = "A"))
distances(asdf, "s", "t")
distances(asdf, "s", "t") < Inf
if(distances(asdf, "s", "t") < Inf) cat("ok")
asdf <- induced_subgraph(asdf, vids=V(asdf)[!(name %in% "A")])
if(distances(asdf, "s", "t") < Inf) cat("ok")
asdf <- data.frame(Probabilit = 0)
asdf
asdf <- data.frame(Probability = 0)
asdf
all(asdf$Probability == 0)
source('~/work/weibull-papers/cbm-rbd/cbm-sim.R')
set.seed(2211)
br1sim5cycle20data <- list()
for (i in 1:20){
br1sim5cycle20data[[i]] <- brWeibullData(5, br1beta, br1mttf)
}
brsim1 <- sim1cycle(sys = br, ctypes = brctypes, compfts = brcompftssim, n0y0 = brn0y0, beta = brbeta,
tnowstep = 0.1, hor = 4, thresh = 0.5, seqlen = 401, prior = FALSE)
source('~/work/weibull-papers/cbm-rbd/cbm-sim.R')
brcompftssim0 <- list(C1 = 10, C2 = 6, C3 = 7, C4 = 10, H = 3.6,  M = 3.7, P1 = 10, P2 = 3, P3 = 4, P4 = 10)
brsim0 <- sim1cycle(sys = br, ctypes = brctypes, compfts = brcompftssim0, n0y0 = brn0y0, beta = brbeta,
tnowstep = 0.25, hor = 4, thresh = 1, seqlen = 401, prior = FALSE)
br0sim$tend
brsim0$tend
brsim0$tfunc
brsim0$costrate
brcompftssim2 <- list(C1 = c(10, 10), C2 = c(6, 6), C3 = c(7, 7), C4 = c(10, 10), H = c(8, 8),
M = c(12, 12), P1 = c(10, 10), P2 = c(3, 3), P3 = c(4, 4), P4 = c(10, 10))
brsim2pr <- simNcycle(sys = br, ctypes = brctypes, compfts = brcompftssim2, n0y0 = brn0y0, beta = brbeta,
tnowstep = 0.5, hor = 4, thresh = 0.5, seqlen = 401, prior = TRUE)
brsim2prpr <- simNcycle(sys = br, ctypes = brctypes, compfts = brcompftssim2, n0y0 = brn0y0, beta = brbeta,
tnowstep = 0.5, hor = 4, thresh = 0.5, seqlen = 401, prior = TRUE, cycleupdate = FALSE)
set.seed(1328)
brcompftssim1 <- brWeibullData(5, brbeta, brmttf)
brcompftssim2 <- brWeibullData(5, brbeta, brmttf)
brcompftssim3 <- brWeibullData(5, brbeta, brmttf)
brsimN51 <- simNcycle(sys = br, ctypes = brctypes, compfts = brcompftssim1, n0y0 = brn0y0, beta = brbeta,
tnowstep = 0.1, hor = 4, thresh = 0.5, seqlen = 401)
brsimN51$tend; brsimN51$costrate
weighted.mean(brsimN51$costrate, brsimN51$tend)
sum(brsimN51$tend)
brsimN51fig1 <- ggplot(brsimN51$res, aes(x = tnow, y = taustar)) +
geom_line(aes(colour = cycle, group = cycle)) + geom_point(aes(colour = cycle, group = cycle)) +
xlab(expression(t[now])) + ylab(expression(paste(tau["*"]^(t[now]), (t[now])))) +
guides(colour = guide_legend(title="Cycle")) + scale_y_continuous(breaks=seq(0, 2, by=0.5), minor_breaks=seq(0, 2, by=0.25))
brsimN51fig1
pdf("brsimN51fig1.pdf", width = 5, height = 3)
brsimN51fig1
dev.off()
br1simN51 <- simNcycle(sys = br, ctypes = brctypes, compfts = br1sim5cycle20data[[1]], n0y0 = br1n0y0, beta = br1beta,
tnowstep = 0.1, hor = 4, thresh = 0.5, seqlen = 401)
br1simN51$tend; br1simN51$tfunc; br1simN51$costrate
br1simN51fig1 <- ggplot(br1simN51$res, aes(x = tnow, y = taustar)) +
geom_line(aes(colour = cycle, group = cycle)) + geom_point(aes(colour = cycle, group = cycle)) +
xlab(expression(t[now])) + ylab(expression(paste(tau["*"]^(t[now]), (t[now])))) +
guides(colour = guide_legend(title="Cycle")) + scale_y_continuous(breaks=seq(0, 2, by=0.5), minor_breaks=seq(0, 2, by=0.25))
pdf("br1simN51fig1.pdf", width = 6, height = 4)
br1simN51fig1
dev.off()
br1sim5cycle20 <- list()
br1sim5cycle30 <- list()
br1sim5cycle30 <- list()
for (i in 1:30){
cat("Repetition", i, "\n")
br1sim5cycle30[[i]] <- simNcycle(sys = br, ctypes = brctypes, compfts = br1sim5cycle20data[[i]], n0y0 = br1n0y0,
beta = br1beta, tnowstep = 0.1, hor = 4, tprep = 0.5, trepa = 0, seqlen = 401)
}
for (i in 1:30){
cat("Repetition", i, "\n")
br1sim5cycle30[[i]] <- simNcycle(sys = br, ctypes = brctypes, compfts = br1sim5cycle20data[[i]], n0y0 = br1n0y0,
beta = br1beta, tnowstep = 0.1, hor = 4, thresh = 0.5, seqlen = 401)
}
.libPath
.libPath()
library(actuar) # provides dinvgamma(x, shape, scale) where shape = alpha and scale = beta
library(ReliabilityTheory)
library(ggplot2)
library(reshape2)
library(gridExtra)
